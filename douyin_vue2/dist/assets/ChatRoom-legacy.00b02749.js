!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}System.register(["./index-legacy.7979773c.js"],(function(e,a){"use strict";var s,i=document.createElement("style");return i.textContent='@charset "UTF-8";#card[data-v-b7e56073]{padding:12px;margin-bottom:5px}#card .avatar[data-v-b7e56073]{width:40px;height:40px;vertical-align:middle}#card .name[data-v-b7e56073]{display:inline-block;padding:10px;margin-bottom:15px;font-size:16px}#card .search[data-v-b7e56073]{background-color:#dbd9d8;width:150px;height:30px;line-height:30px;padding:0 10px;border:0;border-radius:4px;outline:none;color:#fff}#card .searchBtn[data-v-b7e56073]{background-color:#dbd9d8;border:0;margin-left:3px}#card .el-input__inner{background-color:#dbd9d8;outline:none}#list ul[data-v-96c120aa]{padding-left:0;margin-left:2px}#list li[data-v-96c120aa]{padding-top:14px;padding-bottom:14px;list-style:none;cursor:pointer}#list li[data-v-96c120aa]:hover{background-color:#d8d6d6}#list li.active[data-v-96c120aa]{background-color:#c8c6c6}#list .avatar[data-v-96c120aa]{border-radius:2px;width:30px;height:30px;vertical-align:middle}#list .name[data-v-96c120aa]{display:inline-block;margin-left:15px;margin-top:0;margin-bottom:0}#list .userList[data-v-96c120aa]{max-height:600px}#list .el-scrollbar__wrap.default-scrollbar__wrap[data-v-96c120aa]{overflow-x:auto}#message[data-v-304be3b6]{padding:15px;height:60%;max-height:63%;overflow-y:scroll;overflow-x:hidden}#message ul[data-v-304be3b6]{list-style-type:none;padding-left:0}#message ul li[data-v-304be3b6]{margin-bottom:15px}#message .time[data-v-304be3b6]{text-align:center;margin:7px 0}#message .time>span[data-v-304be3b6]{display:inline-block;padding:0 18px;font-size:12px;color:#fff;background-color:#dcdcdc;border-radius:2px}#message .main .avatar[data-v-304be3b6]{float:left;margin:0 10px 0 0;border-radius:3px;width:30px;height:30px}#message .main .text[data-v-304be3b6]{display:inline-block;padding:0 10px;max-width:80%;background-color:#fafafa;border-radius:4px;line-height:30px}#message .main .img[data-v-304be3b6]{display:inline-block;height:100px;width:100px;margin-top:15px}#message .main .username[data-v-304be3b6]{position:relative;left:35px;top:11px;margin:0;padding:0;border-radius:4px;line-height:15px;font-size:10px;color:gray}#message .self[data-v-304be3b6]{text-align:right}#message .self .avatar[data-v-304be3b6]{float:right;margin:0 0 0 10px;border-radius:3px;width:30px;height:30px}#message .self .text[data-v-304be3b6]{display:inline-block;padding:0 10px;max-width:80%;background-color:#b2e281;border-radius:4px;line-height:30px}#message .self .img[data-v-304be3b6]{display:inline-block;height:100px;width:100px;margin-top:15px}#message .self .username[data-v-304be3b6]{position:relative;left:310px;top:11px;margin:0;padding:0;width:200px;line-height:15px;font-size:10px;color:gray}.el-popover{height:200px;width:450px;overflow:scroll;overflow-x:auto}#uesrtext[data-v-28f4c9ca]{position:absolute;bottom:0;right:0;width:100%;height:30%;border:solid 1px #DDD;background-color:#fff}#uesrtext>textarea[data-v-28f4c9ca]{padding:10px;width:95%;height:58%;border:none;outline:none;resize:none}#uesrtext #sendBtn[data-v-28f4c9ca]{float:right;margin-right:10px}#uesrtext #uploadImgBtn[data-v-28f4c9ca]{border:none;padding-bottom:0;margin-bottom:0;padding-left:12px}#uesrtext #uploadImgBtn[data-v-28f4c9ca]:hover{background-color:#fff}#uesrtext #emojiBtn[data-v-28f4c9ca]{border:none;padding-right:0;padding-bottom:0;margin-bottom:0}#uesrtext #emojiBtn[data-v-28f4c9ca]:hover{background-color:#fff}#uesrtext .upload-btn[data-v-28f4c9ca]{display:inline-block}.emotionList[data-v-28f4c9ca]{display:flex;flex-wrap:wrap;padding:5px}.emotionItem[data-v-28f4c9ca]{width:10%;font-size:20px;text-align:center}.emotionItem[data-v-28f4c9ca],.emotionItem[data-v-28f4c9ca]:link,.emotionItem[data-v-28f4c9ca]:visited,.emotionItem[data-v-28f4c9ca]:hover,.emotionItem[data-v-28f4c9ca]:active{text-decoration:none}#toolbar[data-v-22ec3d44]{width:100%;height:100%}#toolbar #btnBar[data-v-22ec3d44]{width:100%;height:82%;display:flex;flex-direction:column;justify-content:space-between}#toolbar .imgProfile[data-v-22ec3d44]{width:40px;height:40px;horiz-align:center;margin:25px 10px}#toolbar .toolBtn[data-v-22ec3d44]{background-color:#2e3238;border:0;margin:5px}#toolbar .feedbackDialog[data-v-22ec3d44]{width:1000px;height:800px;margin:10px auto}#toolbar .feedbackInput[data-v-22ec3d44]{width:450px;height:200px;resize:none;padding:0;margin:0}#moreList[data-v-22ec3d44]{margin:0;padding:0;background-color:#2e3238}#moreList li[data-v-22ec3d44]{padding-top:14px;padding-bottom:14px;padding-left:5px;list-style:none;cursor:pointer}#moreList li[data-v-22ec3d44]:hover{background-color:#abaaaa}.el-popover.moreListPopoverClass{height:150px;width:150px;margin-left:10px;padding:0;overflow-x:hidden;overflow-y:hidden;background-color:#2e3238;border:none}.chatTitle[data-v-b60b9f27]{height:50px;width:100%;font-size:20px;display:flex;justify-content:space-between;border-bottom:.5px solid #c7d2db}.moreBtn[data-v-b60b9f27]{background-color:#eee;border:0;height:40px}.titleName[data-v-b60b9f27]{margin:10px 20px}#app[data-v-0037a9bd]{margin:20px auto;width:900px;height:650px;overflow:hidden;border-radius:10px}#app .sidebar[data-v-0037a9bd],#app .main[data-v-0037a9bd],#app .toolbar[data-v-0037a9bd]{height:100%}#app .toolbar[data-v-0037a9bd]{float:left;color:#f4f4f4;background-color:#2e3238;width:60px}#app .sidebar[data-v-0037a9bd]{float:left;color:#000;background-color:#eceae8;width:240px}#app .main[data-v-0037a9bd]{position:relative;overflow:hidden;background-color:#eee}\n',document.head.appendChild(i),{setters:[function(t){s=t.n}],execute:function(){var a=s({name:"card",data:function(){return{user:JSON.parse(window.sessionStorage.getItem("user"))}}},(function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"card"}},[e("header"),e("footer"),e("el-input",{staticClass:"search",attrs:{type:"text",size:"mini",placeholder:"搜索","prefix-icon":"el-icon-search"},model:{value:t.$store.state.filterKey,callback:function(e){t.$set(t.$store.state,"filterKey",e)},expression:"$store.state.filterKey"}}),e("el-button",{staticClass:"searchBtn",attrs:{size:"mini"}},[e("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}})])],1)}),[],!1,null,"b7e56073",null,null).exports;var i=("undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).__VUE_DEVTOOLS_GLOBAL_HOOK__;function n(t,e){Object.keys(t).forEach((function(a){return e(t[a],a)}))}function o(e){return null!==e&&"object"===t(e)}var r=function(t,e){this.runtime=e,this._children=Object.create(null),this._rawModule=t;var a=t.state;this.state=("function"==typeof a?a():a)||{}},c={namespaced:{configurable:!0}};c.namespaced.get=function(){return!!this._rawModule.namespaced},r.prototype.addChild=function(t,e){this._children[t]=e},r.prototype.removeChild=function(t){delete this._children[t]},r.prototype.getChild=function(t){return this._children[t]},r.prototype.hasChild=function(t){return t in this._children},r.prototype.update=function(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)},r.prototype.forEachChild=function(t){n(this._children,t)},r.prototype.forEachGetter=function(t){this._rawModule.getters&&n(this._rawModule.getters,t)},r.prototype.forEachAction=function(t){this._rawModule.actions&&n(this._rawModule.actions,t)},r.prototype.forEachMutation=function(t){this._rawModule.mutations&&n(this._rawModule.mutations,t)},Object.defineProperties(r.prototype,c);var l,u=function(t){this.register([],t,!1)};function d(t,e,a){if(e.update(a),a.modules)for(var s in a.modules){if(!e.getChild(s))return;d(t.concat(s),e.getChild(s),a.modules[s])}}u.prototype.get=function(t){return t.reduce((function(t,e){return t.getChild(e)}),this.root)},u.prototype.getNamespace=function(t){var e=this.root;return t.reduce((function(t,a){return t+((e=e.getChild(a)).namespaced?a+"/":"")}),"")},u.prototype.update=function(t){d([],this.root,t)},u.prototype.register=function(t,e,a){var s=this;void 0===a&&(a=!0);var i=new r(e,a);0===t.length?this.root=i:this.get(t.slice(0,-1)).addChild(t[t.length-1],i);e.modules&&n(e.modules,(function(e,i){s.register(t.concat(i),e,a)}))},u.prototype.unregister=function(t){var e=this.get(t.slice(0,-1)),a=t[t.length-1],s=e.getChild(a);s&&s.runtime&&e.removeChild(a)},u.prototype.isRegistered=function(t){var e=this.get(t.slice(0,-1)),a=t[t.length-1];return!!e&&e.hasChild(a)};var p=function(t){var e=this;void 0===t&&(t={}),!l&&"undefined"!=typeof window&&window.Vue&&function(t){if(l&&t===l)return;!
/*!
       * vuex v3.6.2
       * (c) 2021 Evan You
       * @license MIT
       */
function(t){if(Number(t.version.split(".")[0])>=2)t.mixin({beforeCreate:a});else{var e=t.prototype._init;t.prototype._init=function(t){void 0===t&&(t={}),t.init=t.init?[a].concat(t.init):a,e.call(this,t)}}function a(){var t=this.$options;t.store?this.$store="function"==typeof t.store?t.store():t.store:t.parent&&t.parent.$store&&(this.$store=t.parent.$store)}}(l=t)}(window.Vue);var a=t.plugins;void 0===a&&(a=[]);var s=t.strict;void 0===s&&(s=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new u(t),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new l,this._makeLocalGettersCache=Object.create(null);var n=this,o=this.dispatch,r=this.commit;this.dispatch=function(t,e){return o.call(n,t,e)},this.commit=function(t,e,a){return r.call(n,t,e,a)},this.strict=s;var c=this._modules.root.state;v(this,c,[],this._modules.root),g(this,c),a.forEach((function(t){return t(e)})),(void 0!==t.devtools?t.devtools:l.config.devtools)&&function(t){i&&(t._devtoolHook=i,i.emit("vuex:init",t),i.on("vuex:travel-to-state",(function(e){t.replaceState(e)})),t.subscribe((function(t,e){i.emit("vuex:mutation",t,e)}),{prepend:!0}),t.subscribeAction((function(t,e){i.emit("vuex:action",t,e)}),{prepend:!0}))}(this)},f={state:{configurable:!0}};function m(t,e,a){return e.indexOf(t)<0&&(a&&a.prepend?e.unshift(t):e.push(t)),function(){var a=e.indexOf(t);a>-1&&e.splice(a,1)}}function h(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var a=t.state;v(t,a,[],t._modules.root,!0),g(t,a,e)}function g(t,e,a){var s=t._vm;t.getters={},t._makeLocalGettersCache=Object.create(null);var i=t._wrappedGetters,o={};n(i,(function(e,a){o[a]=function(t,e){return function(){return t(e)}}(e,t),Object.defineProperty(t.getters,a,{get:function(){return t._vm[a]},enumerable:!0})}));var r=l.config.silent;l.config.silent=!0,t._vm=new l({data:{$$state:e},computed:o}),l.config.silent=r,t.strict&&function(t){t._vm.$watch((function(){return this._data.$$state}),(function(){}),{deep:!0,sync:!0})}(t),s&&(a&&t._withCommit((function(){s._data.$$state=null})),l.nextTick((function(){return s.$destroy()})))}function v(t,e,a,s,i){var n=!a.length,o=t._modules.getNamespace(a);if(s.namespaced&&(t._modulesNamespaceMap[o],t._modulesNamespaceMap[o]=s),!n&&!i){var r=b(e,a.slice(0,-1)),c=a[a.length-1];t._withCommit((function(){l.set(r,c,s.state)}))}var u=s.context=function(t,e,a){var s=""===e,i={dispatch:s?t.dispatch:function(a,s,i){var n=x(a,s,i),o=n.payload,r=n.options,c=n.type;return r&&r.root||(c=e+c),t.dispatch(c,o)},commit:s?t.commit:function(a,s,i){var n=x(a,s,i),o=n.payload,r=n.options,c=n.type;r&&r.root||(c=e+c),t.commit(c,o,r)}};return Object.defineProperties(i,{getters:{get:s?function(){return t.getters}:function(){return function(t,e){if(!t._makeLocalGettersCache[e]){var a={},s=e.length;Object.keys(t.getters).forEach((function(i){if(i.slice(0,s)===e){var n=i.slice(s);Object.defineProperty(a,n,{get:function(){return t.getters[i]},enumerable:!0})}})),t._makeLocalGettersCache[e]=a}return t._makeLocalGettersCache[e]}(t,e)}},state:{get:function(){return b(t.state,a)}}}),i}(t,o,a);s.forEachMutation((function(e,a){!function(t,e,a,s){var i=t._mutations[e]||(t._mutations[e]=[]);i.push((function(e){a.call(t,s.state,e)}))}(t,o+a,e,u)})),s.forEachAction((function(e,a){var s=e.root?a:o+a,i=e.handler||e;!function(t,e,a,s){var i=t._actions[e]||(t._actions[e]=[]);i.push((function(e){var i,n=a.call(t,{dispatch:s.dispatch,commit:s.commit,getters:s.getters,state:s.state,rootGetters:t.getters,rootState:t.state},e);return(i=n)&&"function"==typeof i.then||(n=Promise.resolve(n)),t._devtoolHook?n.catch((function(e){throw t._devtoolHook.emit("vuex:error",e),e})):n}))}(t,s,i,u)})),s.forEachGetter((function(e,a){!function(t,e,a,s){if(t._wrappedGetters[e])return;t._wrappedGetters[e]=function(t){return a(s.state,s.getters,t.state,t.getters)}}(t,o+a,e,u)})),s.forEachChild((function(s,n){v(t,e,a.concat(n),s,i)}))}function b(t,e){return e.reduce((function(t,e){return t[e]}),t)}function x(t,e,a){return o(t)&&t.type&&(a=e,e=t,t=t.type),{type:t,payload:e,options:a}}f.state.get=function(){return this._vm._data.$$state},f.state.set=function(t){},p.prototype.commit=function(t,e,a){var s=this,i=x(t,e,a),n=i.type,o=i.payload,r={type:n,payload:o},c=this._mutations[n];c&&(this._withCommit((function(){c.forEach((function(t){t(o)}))})),this._subscribers.slice().forEach((function(t){return t(r,s.state)})))},p.prototype.dispatch=function(t,e){var a=this,s=x(t,e),i=s.type,n=s.payload,o={type:i,payload:n},r=this._actions[i];if(r){try{this._actionSubscribers.slice().filter((function(t){return t.before})).forEach((function(t){return t.before(o,a.state)}))}catch(l){}var c=r.length>1?Promise.all(r.map((function(t){return t(n)}))):r[0](n);return new Promise((function(t,e){c.then((function(e){try{a._actionSubscribers.filter((function(t){return t.after})).forEach((function(t){return t.after(o,a.state)}))}catch(l){}t(e)}),(function(t){try{a._actionSubscribers.filter((function(t){return t.error})).forEach((function(e){return e.error(o,a.state,t)}))}catch(l){}e(t)}))}))}},p.prototype.subscribe=function(t,e){return m(t,this._subscribers,e)},p.prototype.subscribeAction=function(t,e){return m("function"==typeof t?{before:t}:t,this._actionSubscribers,e)},p.prototype.watch=function(t,e,a){var s=this;return this._watcherVM.$watch((function(){return t(s.state,s.getters)}),e,a)},p.prototype.replaceState=function(t){var e=this;this._withCommit((function(){e._vm._data.$$state=t}))},p.prototype.registerModule=function(t,e,a){void 0===a&&(a={}),"string"==typeof t&&(t=[t]),this._modules.register(t,e),v(this,this.state,t,this._modules.get(t),a.preserveState),g(this,this.state)},p.prototype.unregisterModule=function(t){var e=this;"string"==typeof t&&(t=[t]),this._modules.unregister(t),this._withCommit((function(){var a=b(e.state,t.slice(0,-1));l.delete(a,t[t.length-1])})),h(this)},p.prototype.hasModule=function(t){return"string"==typeof t&&(t=[t]),this._modules.isRegistered(t)},p.prototype.hotUpdate=function(t){this._modules.update(t),h(this,!0)},p.prototype._withCommit=function(t){var e=this._committing;this._committing=!0,t(),this._committing=e},Object.defineProperties(p.prototype,f);var y,_=(y=function(t,e){var a,s={};return(a=e,function(t){return Array.isArray(t)||o(t)}(a)?Array.isArray(a)?a.map((function(t){return{key:t,val:t}})):Object.keys(a).map((function(t){return{key:t,val:a[t]}})):[]).forEach((function(e){var a=e.key,i=e.val;s[a]=function(){var e=this.$store.state,a=this.$store.getters;if(t){var s=function(t,e,a){var s=t._modulesNamespaceMap[a];return s}(this.$store,0,t);if(!s)return;e=s.context.state,a=s.context.getters}return"function"==typeof i?i.call(this,e,a):e[i]},s[a].vuex=!0})),s},function(t,e){return"string"!=typeof t?(e=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),y(t,e)});var C={name:"list",data:function(){return{user:this.$store.state.currentUser,chatObj:{username:"群聊",nickname:"群聊"},robotObj:{username:"机器人",nickname:"机器人",userProfile:"https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=2548892998,499717296&fm=26&gp=0.jpg"}}},computed:_(["users","currentSession","isDot","currentList"]),methods:{changeCurrentSession:function(t){this.$store.commit("changeCurrentSession",t)}}},w=s(C,(function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"list"}},["群聊"==t.currentList?e("ul",[e("p",{staticStyle:{padding:"2px 4px",height:"20px"}},[t._v("群聊列表")]),e("li",{class:{active:!!t.currentSession&&"群聊"==t.currentSession.username},on:{click:function(e){return t.changeCurrentSession(t.chatObj)}}},[e("img",{staticClass:"avatar",attrs:{src:"https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=1268761962,3976237305&fm=26&gp=0.jpg"}}),e("el-badge",{attrs:{"is-dot":t.isDot[t.user.username+"#群聊"]}},[e("p",{staticClass:"name"},[t._v("群聊")])])],1)]):t._e(),"机器人"==t.currentList?e("ul",[e("p",{staticStyle:{padding:"2px 4px",height:"20px"}},[t._v("快来和机器人聊天吧！")]),e("li",{class:{active:!!t.currentSession&&"机器人"==t.currentSession.username},on:{click:function(e){return t.changeCurrentSession(t.robotObj)}}},[e("img",{staticClass:"avatar",attrs:{src:"https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=2548892998,499717296&fm=26&gp=0.jpg"}}),e("p",{staticClass:"name"},[t._v("瓦力(智能回复)")])])]):t._e(),e("el-scrollbar",{attrs:{"wrap-class":"userList","wrap-style":"height:600px;","view-style":"height:100%;",native:!1}},["私聊"==t.currentList?e("ul",[e("p",{staticStyle:{padding:"2px 4px",height:"20px"}},[t._v("用户列表")]),t._l(t.users,(function(a){return e("li",{class:{active:!!t.currentSession&&a.username===t.currentSession.username},on:{click:function(e){return t.changeCurrentSession(a)}}},[e("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e("div",[e("el-badge",{attrs:{"is-dot":t.isDot[t.user.username+"#"+a.username]}},[e("el-image",{staticClass:"avatar",attrs:{"preview-src-list":[a.userProfile],src:a.userProfile,alt:a.nickname}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])])],1),e("p",{staticClass:"name"},[t._v(t._s(a.nickname))])],1),e("div",[e("el-badge",{attrs:{value:1==a.userStateId?"在线":"离线",type:1==a.userStateId?"danger":"info"}})],1)])])}))],2):t._e()])],1)}),[],!1,null,"96c120aa",null,null).exports,k={name:"message",data:function(){return{user:JSON.parse(window.sessionStorage.getItem("user"))}},computed:_(["sessions","currentSession","errorImgUrl"]),filters:{time:function(t){t&&(t=new Date(t));var e=new Date,a=e.getDate()-t.getDate(),s="上午";return t.getHours()>12&&(s="下午"),t.getMonth()==e.getMonth()&&t.getDate()==e.getDate()?"".concat(s," ").concat(t.getHours(),":").concat(t.getMinutes()):t.getFullYear()==e.getFullYear()&&a<=6&&a>=1?1==a?"昨天 ".concat(s," ").concat(t.getHours(),":").concat(t.getMinutes()):"".concat(["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][t.getDay()]," ").concat(s," ").concat(t.getHours(),":").concat(t.getMinutes()):"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate()," ").concat(s,"  ").concat(t.getHours(),":").concat(t.getMinutes())}},directives:{"scroll-bottom":function(t){setTimeout((function(){t.scrollTop+=9999}),1)}},methods:{takeAShot:function(t,e){console.log("拍了一怕")}}},S=s(k,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"scroll-bottom",rawName:"v-scroll-bottom",value:t.sessions,expression:"sessions"}],attrs:{id:"message"}},[t.currentSession&&"群聊"!=t.currentSession.username?e("div",[e("ul",t._l(t.sessions[t.user.username+"#"+t.currentSession.username],(function(a){return e("li",[e("p",{staticClass:"time"},[e("span",[t._v(t._s(t._f("time")(a.date)))])]),e("div",{staticClass:"main",class:{self:a.self}},[e("p",{staticClass:"username"},[t._v(t._s(a.fromNickname))]),e("img",{staticClass:"avatar",attrs:{src:a.self?t.user.userProfile:t.currentSession.userProfile,alt:""}}),1==a.messageTypeId?e("p",{staticClass:"text"},[t._v(t._s(a.content))]):t._e(),2==a.messageTypeId?e("img",{staticClass:"img",attrs:{src:a.content}}):t._e()])])})),0)]):e("div",[e("ul",t._l(t.sessions["群聊"],(function(a){return e("li",{key:a.id},[e("p",{staticClass:"time"},[e("span",[t._v(t._s(t._f("time")(a.createTime)))])]),e("div",{staticClass:"main",class:{self:a.fromId==t.user.id}},[e("p",{staticClass:"username"},[t._v(t._s(a.fromName))]),e("img",{staticClass:"avatar",attrs:{src:a.fromId==t.user.id?t.user.userProfile:a.fromProfile,alt:""},on:{dblclick:t.takeAShot}}),1==a.messageTypeId?e("div",[e("p",{staticClass:"text",domProps:{innerHTML:t._s(a.content)}})]):e("div",[e("el-image",{staticClass:"img",attrs:{src:a.content,"preview-src-list":[a.content]}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])])],1)])])})),0)])])}),[],!1,null,"304be3b6",null,null).exports,$=require("../../utils/emoji.json"),B={name:"uesrtext",data:function(){return{faceList:[],content:""}},mounted:function(){for(var t in $)this.faceList.push($[t].char)},computed:_(["sessions","currentSession"]),methods:{addMessageByClick:function(){if(this.content&&!this.content.match(/^[ ]*$/)){var t=new Object;t.content=this.content,t.messageTypeId=1,"群聊"==this.currentSession.username&&(console.log(this.content),this.$store.state.stomp.send("/ws/groupChat",{},JSON.stringify(t))),"机器人"==this.currentSession.username?(t.fromNickname=this.$store.state.currentUser.nickname,t.to="机器人",this.$store.state.stomp.send("/ws/robotChat",{},JSON.stringify(t)),this.$store.commit("addMessage",t)):(t.from=this.$store.state.currentUser.username,t.fromNickname=this.$store.state.currentUser.nickname,t.to=this.currentSession.username,this.$store.state.stomp.send("/ws/chat",{},JSON.stringify(t)),this.$store.commit("addMessage",t)),this.content=""}else this.$message({showClose:!0,message:"不能发送空白信息"})},addMessage:function(t){t.ctrlKey&&13===t.keyCode&&this.content.length&&this.addMessageByClick()},beforeAvatarUpload:function(t){"机器人"==this.currentSession.username&&this.$message.error("瓦力拒绝接收你的图片！");var e=t.size/1024/1024<1;console.log(t),e||this.$message.error("上传图片大小不能超过 1MB!");var a=t.name.substring(t.name.lastIndexOf(".")+1),s="jpg"===(a=a.toLowerCase())||"png"===a||"jpeg"===a||"gif"===a;return s||this.$message.error("上传图片格式不符合要求！"),e&&s},imgSuccess:function(t,e,a){console.log("图片url为："+t);var s=new Object;s.content=t,s.messageTypeId=2,"群聊"==this.currentSession.username?this.$store.state.stomp.send("/ws/groupChat",{},JSON.stringify(s)):(s.from=this.$store.state.currentUser.username,s.fromNickname=this.$store.state.currentUser.nickname,s.to=this.currentSession.username,this.$store.state.stomp.send("/ws/chat",{},JSON.stringify(s)),this.$store.commit("addMessage",s))},imgError:function(t,e,a){this.$message.error("上传失败")},getEmo:function(t){var e=document.getElementById("textarea");!function(t,a){if(window.getSelection)e.setRangeText(a),e.selectionStart+=a.length,e.focus();else if(document.selection){t.focus(),document.selection.createRange().text=a}}(e,this.faceList[t]),this.content=e.value}}},j=s(B,(function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"uesrtext"}},[e("div",[e("el-popover",{staticClass:"emoBox",attrs:{placement:"top-start",width:"400",trigger:"click"}},[e("div",{staticClass:"emotionList"},t._l(t.faceList,(function(a,s){return e("a",{key:s,staticClass:"emotionItem",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.getEmo(s)}}},[t._v(t._s(a))])})),0),e("el-button",{staticClass:"emotionSelect",attrs:{slot:"reference",id:"emojiBtn"},slot:"reference"},[e("i",{staticClass:"fa fa-smile-o",attrs:{"aria-hidden":"true"}})])],1),e("el-upload",{staticClass:"upload-btn",attrs:{action:"/ossFileUpload?module=group-chat","before-upload":t.beforeAvatarUpload,"on-success":t.imgSuccess,"on-error":t.imgError,"show-file-list":!1,accept:".jpg,.jpeg,.png,.JPG,JPEG,.PNG,.gif,.GIF"}},[e("el-button",{attrs:{id:"uploadImgBtn",icon:"el-icon-picture-outline"}})],1)],1),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],attrs:{id:"textarea",placeholder:"按 Ctrl + Enter 发送"},domProps:{value:t.content},on:{keyup:t.addMessage,input:function(e){e.target.composing||(t.content=e.target.value)}}}),e("el-button",{attrs:{id:"sendBtn",type:"primary",size:"mini"},on:{click:t.addMessageByClick}},[t._v("发送(S)")])],1)}),[],!1,null,"28f4c9ca",null,null).exports,O=s({name:"toolbar",data:function(){return{user:JSON.parse(window.sessionStorage.getItem("user")),feedBackDialogVisible:!1,feedBackContent:""}},methods:{exitSystem:function(){var t=this;this.$confirm("你是否要退出系统吗?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.getRequest("/logout"),sessionStorage.removeItem("user"),sessionStorage.getItem("state")&&sessionStorage.removeItem("state"),t.$store.dispatch("disconnect"),t.$router.replace("/")})).catch((function(){t.$message({type:"info",message:"已取消操作"})}))},chooseChatList:function(t){this.$store.commit("changeCurrentList",t)},showFeedbackDialog:function(){this.feedBackContent="",this.feedBackDialogVisible=!0},handleFeedbackSend:function(){var t=this,e={};e.userId=this.user.id,e.nickname=this.user.nickname,e.username=this.user.username,e.content=this.feedBackContent,console.log(e),this.postRequest("/mail/feedback",e).then((function(e){e&&(t.feedBackDialogVisible=!1)}))},clearChatHistory:function(){var t=this;this.$confirm("此操作将永久删除本地聊天记录(群聊记录会在下次登录时恢复), 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){localStorage.getItem("chat-session")&&localStorage.removeItem("chat-session"),t.$store.state.sessionStorage={},sessionStorage.getItem("state")&&sessionStorage.removeItem("state"),t.$message({type:"success",message:"删除成功"})})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},(function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"toolbar"}},[e("el-image",{staticClass:"imgProfile",attrs:{src:t.user.userProfile,"preview-src-list":[t.user.userProfile],alt:t.user.nickname}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])]),e("div",{attrs:{id:"btnBar"}},[e("div",{staticClass:"topBtnBar"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"进入群聊",placement:"right"}},[e("el-button",{staticClass:"toolBtn",attrs:{size:"small"},on:{click:function(e){return t.chooseChatList("群聊")}}},[e("i",{staticClass:"fa fa-comments fa-2x",attrs:{"aria-hidden":"true"}})])],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"用户列表",placement:"right"}},[e("el-button",{staticClass:"toolBtn",attrs:{size:"small"},on:{click:function(e){return t.chooseChatList("私聊")}}},[e("i",{staticClass:"fa fa-address-book-o fa-2x",attrs:{"aria-hidden":"true"}})])],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"与机器人聊天",placement:"right"}},[e("el-button",{staticClass:"toolBtn",attrs:{size:"small"},on:{click:function(e){return t.chooseChatList("机器人")}}},[e("i",{staticClass:"fa fa-android fa-2x",attrs:{"aria-hidden":"true"}})])],1)],1),e("div",{staticClass:"bottomBtnBar"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"个人中心",placement:"right"}},[e("el-button",{staticClass:"toolBtn",attrs:{size:"small"}},[e("i",{staticClass:"fa fa-user fa-2x",attrs:{"aria-hidden":"true"}})])],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"更多",placement:"right"}},[e("el-popover",{attrs:{placement:"right",width:"180",trigger:"click","popper-class":"moreListPopoverClass"}},[e("ul",{attrs:{id:"moreList"}},[e("li",{on:{click:t.showFeedbackDialog}},[t._v("意见反馈")]),e("li",[t._v("举报")]),e("li",{on:{click:t.clearChatHistory}},[t._v("清空聊天记录")])]),e("el-button",{staticClass:"toolBtn",attrs:{slot:"reference",size:"small"},slot:"reference"},[e("i",{staticClass:"fa fa-bars fa-2x",attrs:{"aria-hidden":"true"}})])],1)],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"退出",placement:"right"}},[e("el-button",{staticClass:"toolBtn",attrs:{size:"small"},on:{click:t.exitSystem}},[e("i",{staticClass:"fa fa-sign-out fa-2x",attrs:{"aria-hidden":"true"}})])],1)],1)]),e("el-dialog",{staticClass:"feedbackDialog",attrs:{title:"意见反馈",visible:t.feedBackDialogVisible},on:{"update:visible":function(e){t.feedBackDialogVisible=e}}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.feedBackContent,expression:"feedBackContent"}],staticClass:"feedbackInput",domProps:{value:t.feedBackContent},on:{input:function(e){e.target.composing||(t.feedBackContent=e.target.value)}}}),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.handleFeedbackSend}},[t._v("确 定")]),e("el-button",{on:{click:function(e){t.feedBackDialogVisible=!1}}},[t._v("取 消")])],1)])],1)}),[],!1,null,"22ec3d44",null,null).exports,M=s({name:"chattitle"},(function(){var t=this,e=t._self._c;return e("div",{staticClass:"chatTitle"},[e("span",{staticClass:"titleName"},[t._v(t._s(this.$store.state.currentSession.nickname?this.$store.state.currentSession.nickname:""))]),e("el-button",{staticClass:"moreBtn",attrs:{size:"small",icon:"el-icon-more"}})],1)}),[],!1,null,"b60b9f27",null,null).exports;e("default",s({name:"ChatRoom",data:function(){return{}},mounted:function(){this.$store.dispatch("initData"),this.$store.dispatch("connect")},created:function(){var t=this;window.addEventListener("beforeunload",(function(){sessionStorage.setItem("state",JSON.stringify(t.$store.state))}))},components:{toolbar:O,card:a,list:w,message:S,usertext:j,chattitle:M}},(function(){var t=this._self._c;return t("div",{attrs:{id:"app"}},[t("div",{staticClass:"toolbar"},[t("toolbar")],1),t("div",{staticClass:"sidebar"},[t("card"),t("list")],1),t("div",{staticClass:"main"},[t("chattitle"),t("message"),t("usertext")],1)])}),[],!1,null,"0037a9bd",null,null).exports)}}}))}();
